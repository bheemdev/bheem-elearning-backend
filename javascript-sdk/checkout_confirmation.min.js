"use strict";var _slicedToArray=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var a=[],n=!0,r=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(n=(o=l.next()).done)&&(a.push(o.value),!t||a.length!==t);n=!0);}catch(e){r=!0,i=e}finally{try{!n&&l.return&&l.return()}finally{if(r)throw i}}return a}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")};function _defineProperty(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var _MaterialUI=MaterialUI,Button=_MaterialUI.Button,Card=_MaterialUI.Card,CardActions=_MaterialUI.CardActions,CardContent=_MaterialUI.CardContent,CardMedia=_MaterialUI.CardMedia,CssBaseline=_MaterialUI.CssBaseline,Grid=_MaterialUI.Grid,Typography=_MaterialUI.Typography,makeStyles=_MaterialUI.makeStyles,Container=_MaterialUI.Container,IconButton=_MaterialUI.IconButton,SkipNextIcon=_MaterialUI.SkipNextIcon,SkipPreviousIcon=_MaterialUI.SkipPreviousIcon,PlayArrowIcon=_MaterialUI.PlayArrowIcon,useTheme=_MaterialUI.useTheme,TextField=_MaterialUI.TextField,FormControlLabel=_MaterialUI.FormControlLabel,Checkbox=_MaterialUI.Checkbox,Avatar=_MaterialUI.Avatar,ListItem=_MaterialUI.ListItem,ListItemAvatar=_MaterialUI.ListItemAvatar,ListItemText=_MaterialUI.ListItemText,ListItemSecondaryAction=_MaterialUI.ListItemSecondaryAction,Divider=_MaterialUI.Divider,FormControl=_MaterialUI.FormControl,InputLabel=_MaterialUI.InputLabel,Select=_MaterialUI.Select,MenuItem=_MaterialUI.MenuItem,FormHelperText=_MaterialUI.FormHelperText,Modal=_MaterialUI.Modal,List=_MaterialUI.List,Backdrop=_MaterialUI.Backdrop,Fade=_MaterialUI.Fade,CircularProgress=_MaterialUI.CircularProgress,backendBaseUrl=TOKOONLINE_BASEURL,useStyles=makeStyles((function(e){return{root:{margin:8,backgroundColor:e.palette.background.paper,overflow:"hidden"},margin:{margin:e.spacing(1)},modal:{display:"flex",alignItems:"center",justifyContent:"center"},paper:{backgroundColor:e.palette.background.paper,border:"2px solid #000",boxShadow:e.shadows[5],padding:e.spacing(2,4,3)}}}));function getCookie(e){console.log("document.cookie",document.cookie);for(var t=e+"=",a=decodeURIComponent(document.cookie).split(";"),n=0;n<a.length;n++){for(var r=a[n];" "==r.charAt(0);)r=r.substring(1);if(0==r.indexOf(t))return r.substring(t.length,r.length)}return""}function setCookie(e,t,a){console.log("setCookie===>",e);var n=new Date;n.setTime(n.getTime()+24*a*60*60*1e3);var r="expires="+n.toUTCString();document.cookie=e+"="+t+";"+r+";path=/*"}function App(){localStorage.getItem(TOKOONLINE_TOKOID)||localStorage.setItem(TOKOONLINE_TOKOID,""+(new Date).getTime());var e=useStyles(),t=(useTheme(),React.useState({error:null,listData:null,pageCount:0,pageIndex:0,pageSize:0,count:0,reload:0,isRequest:!0})),a=_slicedToArray(t,2),n=a[0],r=a[1],i=React.useState({error:null,isRequest:!1}),o=_slicedToArray(i,2),l=(o[0],o[1],React.useState({payload:{},error:null,isRequest:!1})),c=_slicedToArray(l,2),s=c[0],d=c[1],p=React.useState({modalOpen:!1,error:null,isRequest:!1}),u=_slicedToArray(p,2),m=u[0],g=u[1],_=React.useState({error:null,isRequest:!1}),y=_slicedToArray(_,2),h=(y[0],y[1],React.useState({error:null,detailData:null,isRequest:!1})),f=_slicedToArray(h,2),I=f[0],b=f[1],R=React.useState(0),v=_slicedToArray(R,2),T=v[0],O=v[1],S=React.useState(""),k=_slicedToArray(S,2),C=k[0],E=k[1],N=React.useState(""),M=_slicedToArray(N,2),U=M[0],A=M[1],P=(n.count,n.pageCount,n.listData),L=n.pageIndex,x=n.pageSize,B=n.reload,D=React.useCallback((function(e){e.pageSize,e.pageIndex;var t='query{\n      getAllTokoCartsBySessionId(session_id: "'+localStorage.getItem(TOKOONLINE_TOKOID)+'", page_size: 10, page_index: 0){\n        error,\n        count,\n        page_count,\n        status,\n        is_need_shipping,\n        list_data{\n          _id,\n          product_id{\n            _id,\n            code,\n            price,\n            name,\n            description,\n            image_id{\n              _id,\n              filename,\n              file_type\n            }\n          },\n          toko_id{\n            name\n          },\n          count,\n          amount\n        }\n      }\n    }',a={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:t})};fetch(backendBaseUrl+"/graphql",a).then((function(e){return e.json()})).then((function(e){return console.log("response===>",e),e.data.getAllTokoCartsBySessionId})).then((function(e){return r({listData:e.list_data,pageCount:e.page_count,isNeedShipping:e.is_need_shipping,count:e.count,isRequest:!1})}))}),[]);React.useEffect((function(){D({pageSize:x,pageIndex:L})}),[D,L,x,B]);var j=React.useCallback((function(){var e='query{\n      getDetailTokoPoBySessionId(session_id: "'+localStorage.getItem(TOKOONLINE_TOKOID)+'"){\n          error,\n          status,\n          data_detail{\n            _id,\n            email,\n            full_name,\n            invoice_code,\n            phone_number,\n            shipping_address,\n            total_amount,\n            total_product_amount,\n            shipping_amount,\n            shipping_province,\n            shipping_city,\n            shipping_subcity,\n            shipping_currier,\n            shipping_postal_code\n          }\n        }\n      }',t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:e})};fetch(backendBaseUrl+"/graphql",t).then((function(e){return e.json()})).then((function(e){return console.log("getDetailTokoPoBySessionId response===>",e),e.data.getDetailTokoPoBySessionId})).then((function(e){e&&(b({detailData:e.data_detail,isRequest:!1,error:null}),O((e.data_detail||{}).shipping_amount),d({payload:{full_name:(e.data_detail||{}).full_name,email:(e.data_detail||{}).email,phone_number:(e.data_detail||{}).phone_number,shipping_address:(e.data_detail||{}).shipping_address,shipping_amount:(e.data_detail||{}).shipping_amount,shipping_province:(e.data_detail||{}).shipping_province,shipping_city:(e.data_detail||{}).shipping_city,shipping_subcity:(e.data_detail||{}).shipping_subcity,shipping_currier:(e.data_detail||{}).shipping_currier,shipping_postal_code:(e.data_detail||{}).shipping_postal_code}}))}))}),[]);React.useEffect((function(){j()}),[j]),React.useEffect((function(){j()}),[j]);var q=(I.detailData||{}).full_name;console.log("purchaseOrderDetailRequest.detailData======>",q);var w=function(e){var t,a=e.name,n=e.label,r=e.value,i=(e.defaultValue,e.option),o=e.row;return React.createElement(Grid,(_defineProperty(t={item:!0},"item",!0),_defineProperty(t,"xs",12),_defineProperty(t,"md","area"==i?12:6),t),React.createElement(TextField,{id:a,label:n,fullWidth:!0,defaultValue:r,value:r,multiline:!0,disabled:!0,rows:o,InputLabelProps:{shrink:!0},onChange:function(e){return d({payload:Object.assign({},s.payload,_defineProperty({},a,e.target.value))})}}))},K=function(e){var t=(e||0).toString().split("").reverse().join("").match(/\d{1,3}/g);return"Rp. "+(t=t.join(".").split("").reverse().join(""))};return React.createElement("div",null,React.createElement(CssBaseline,null),n.isRequest?React.createElement(Grid,{container:!0,spacing:0,direction:"column",alignItems:"center",justify:"center",style:{minHeight:"100vh"}},React.createElement(CircularProgress,null)):React.createElement(Grid,{container:!0},React.createElement(Grid,{item:!0,xs:12,sm:12,md:12,lg:6},React.createElement(Card,{className:e.root},React.createElement(CardContent,null,React.createElement(List,null,(P||[]).map((function(t,a){var n=t.amount,r=t.count,i=t.product_id._id;return function(t){var a=t.productImage,n=t.productName,r=t.productPrice,i=t.index,o=(t.amount,t.count);return t.productId,React.createElement("div",{key:i},React.createElement(ListItem,{button:!0},React.createElement(ListItemAvatar,null,React.createElement(Avatar,{alt:"Avatar nÂ°"+(i+1),src:backendBaseUrl+"/renderfile/"+a.filename+"."+a.file_type})),React.createElement(ListItemText,{primary:n,secondary:React.createElement(React.Fragment,null,"Qty :  "+o)}),React.createElement(ListItemSecondaryAction,null,React.createElement(Typography,{component:"span",variant:"caption",className:e.inline,color:"textPrimary"},K(r)))),React.createElement(Divider,{component:"li"}))}({amount:n,count:r,productName:t.product_id.name,productPrice:t.product_id.price,productImage:(t.product_id||{}).image_id||{},index:a,productId:i})})),"Y"==n.isNeedShipping?React.createElement(Grid,{container:!0,direction:"row",justify:"space-between",alignItems:"center"},React.createElement(Typography,{variant:"caption",style:{marginLeft:16,marginTop:16}},"Ongkir"),React.createElement(Typography,{variant:"caption",color:"error",style:{marginRight:16,marginTop:16}},K(T))):[],React.createElement(Grid,{container:!0,direction:"row",justify:"space-between",alignItems:"center"},React.createElement(Typography,{variant:"subtitle1",style:{marginLeft:16,marginTop:16}},"Total"),React.createElement(Typography,{variant:"subtitle1",color:"error",style:{marginRight:16,marginTop:16}},K((P||[]).map((function(e,t){return e.amount})).reduce((function(e,t){return parseInt(e)+parseInt(t)+parseInt(T)}),0)))))))),React.createElement(Grid,{item:!0,xs:12,sm:12,md:12,lg:6},React.createElement(Card,{className:e.root},React.createElement(CardContent,null,React.createElement(Typography,{variant:"h6",gutterBottom:!0},"Customer Data"),React.createElement(Grid,{container:!0,spacing:2},w({name:"full_name",label:"Nama *",value:(s.payload||{}).full_name,defaultValue:""}),w({name:"phone_number",label:"Nomor Telepon *",value:(s.payload||{}).phone_number,defaultValue:""}),w({name:"email",label:"Email *",value:(s.payload||{}).email,defaultValue:""}),"Y"==n.isNeedShipping?w({name:"shipping_province",label:"Provinsi *",value:(s.payload||{}).shipping_province,defaultValue:""}):[],"Y"==n.isNeedShipping?w({name:"shipping_city",label:"Kota *",value:(s.payload||{}).shipping_city,defaultValue:""}):[],"Y"==n.isNeedShipping?w({name:"shipping_subcity",label:"Kecamatan *",value:(s.payload||{}).shipping_subcity,defaultValue:""}):[],"Y"==n.isNeedShipping?w({name:"shipping_postal_code",label:"Kode pos",value:(s.payload||{}).shipping_postal_code,defaultValue:""}):[],"Y"==n.isNeedShipping?w({name:"shipping_currier",label:"Layanan kurir *",value:(s.payload||{}).shipping_currier,defaultValue:""}):[],w({name:"shipping_address",label:"Alamat lengkap *",option:"area",value:(s.payload||{}).shipping_address,defaultValue:"-"}))),React.createElement(CardActions,null,React.createElement(Button,{style:{margin:8},size:"small",variant:"outlined",onClick:function(){window.location.href=TOKOONLINE_PAGE_SHOPPING_CART},className:e.button},"Keranjang"),React.createElement(Button,{style:{margin:8},size:"small",variant:"contained",color:"primary",disableElevation:!0,onClick:function(){var e='mutation{\n              paymentProcessSendOtp(email: "'+(s.payload||{}).email+'", session_id: "'+localStorage.getItem(TOKOONLINE_TOKOID)+'"){\n                status,\n                error,\n                otpRefNum\n              }\n            }',t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:e})};fetch(backendBaseUrl+"/graphql",t).then((function(e){return e.json()})).then((function(e){return console.log("response===>",e),e.errors?alert(JSON.stringify(e.errors)):e.data.paymentProcessSendOtp})).then((function(e){if(e.error)return alert(e.error);E(e.otpRefNum),g(Object.assign({},m,{modalOpen:!0}))}))},className:e.button},"Checkout"))))),React.createElement(Modal,{open:m.modalOpen,onClose:function(){return g(Object.assign({},m,{modalOpen:!1}))},"aria-labelledby":"transition-modal-title","aria-describedby":"transition-modal-description",disableBackdropClick:!0,BackdropComponent:Backdrop,BackdropProps:{timeout:500},className:e.modal},React.createElement(Fade,{in:m.modalOpen},React.createElement("div",{className:e.paper},React.createElement(Grid,{container:!0,spacing:2,direction:"column",justify:"center",alignItems:"center"},React.createElement("h2",{id:"simple-modal-title"},"Konfirmasi"),React.createElement("p",{id:"simple-modal-description"},"Masukkan kode otp yang dikirimkan ke email anda"),React.createElement(TextField,{onChange:function(e){A(e.target.value)},id:"outlined-basic",label:"OTP",variant:"outlined",style:{maxWidth:70}}),React.createElement(Grid,{container:!0,direction:"row",justify:"space-around",alignItems:"center",style:{marginTop:20}},React.createElement(Button,{type:"button",size:"small",color:"secondary",onClick:function(){return g(Object.assign({},m,{modalOpen:!1}))}},"Batal"),React.createElement(Button,{type:"button",size:"small",color:"primary",onClick:function(){return function(){if(console.log("paymentProcess"),"undefined"===U||null==U)return alert("otp kosong");var e='mutation\n    {\n      paymentProcess(\n            session_id: "'+localStorage.getItem(TOKOONLINE_TOKOID)+'",\n            otp: "'+U+'",\n            otpRefNum: "'+C+'"\n          )\n      {\n        status,\n        error,\n        payment_page_url,\n        debitin_paymentpage_backend_baseurl\n      }\n    }';console.log("req =====> "+e);var t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:e})};fetch(backendBaseUrl+"/graphql",t).then((function(e){return e.json()})).then((function(e){return console.log("response===>",e),e.errors?alert(JSON.stringify(e.errors)):e.data.paymentProcess})).then((function(e){if(e){if(g({error:e.error,isRequest:!1,modalOpen:!1}),console.log("data=====>"+e.error),e.error)return alert(e.error);localStorage.setItem(TOKOONLINE_TOKOID,""+(new Date).getTime()),window.location.href=e.debitin_paymentpage_backend_baseurl+e.payment_page_url}}))}()}},"Ok")))))))}ReactDOM.render(React.createElement(App,null),document.querySelector("#tokoonline_content"));